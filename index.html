<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TRIBAL IS COMING FOR YOU</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="assets/style.css">
  <link rel="stylesheet" href="assets/compliance.css">
</head>

<body>

<main class="container">
  <h1>TRIBAL IS COMING FOR YOU</h1>

  <form id="signupForm">

    <input
      type="email"
      id="email"
      name="email"
      placeholder="Enter your email"
      required
    >

    <input type="hidden" id="timestamp" name="timestamp">
    <input type="hidden" id="user_agent" name="user_agent">

    <div class="form-wrap">

      <div class="checkbox-group tiny">
        <label>
          <input type="checkbox" required>
          I am 18+.
        </label>

        <label>
          <input type="checkbox" required>
          I agree to the
          <a href="/terms.html" target="_blank" rel="noopener noreferrer">
            Terms &amp; Policies
          </a>
          including
          <a href="/terms.html#cookies" target="_blank" rel="noopener noreferrer">
            All Cookies.
          </a>
        </label>

        <label class="email-consent">
          <input type="checkbox" required>
          <span>
            By submitting your email address, you consent to receive email
            communications only from TRIBAL III Inc. regarding updates,
            announcements, events, and related opportunities.
            <br>
            No phone calls or text messages.
            <br>
            You may unsubscribe at any time by clicking the “unsubscribe” link
            included in every email.
          </span>
        </label>
      </div>

    </div>

    <button type="submit" class="grow-btn">GROW</button>

  </form>
</main>

<footer class="site-footer">
  <nav>
    <a href="/terms.html" target="_blank" rel="noopener noreferrer">
      Terms &amp; Policies
    </a>
    <a href="/terms.html#cookies" target="_blank" rel="noopener noreferrer">
      Cookies
    </a>
    <a href="/terms.html#accessibility" target="_blank" rel="noopener noreferrer">
      Accessibility
    </a>
  </nav>

  <div>This site collects email addresses only. No SMS or phone calls. Unsubscribe anytime.</div>
  <div>© 2025 Tribal. All rights reserved.</div>
</footer>

<div id="successToast">Successfully submitted</div>
<script>
const form = document.getElementById("signupForm");
const emailInput = document.getElementById("email");
const successToast = document.getElementById("successToast");

const WORKER_URL =
  "https://tribal-ip-proxy.tribaloperations.workers.dev";

form.addEventListener("submit", function (e) {
  e.preventDefault();

  if (!form.checkValidity()) {
    form.reportValidity();
    return;
  }

  document.getElementById("timestamp").value = new Date().toISOString();
  document.getElementById("user_agent").value = navigator.userAgent;

  grecaptcha.ready(function () {
    grecaptcha.execute(
      "6LdDTj4sAAAAAK4Mvik32d2ljlf87pDxAwoMx32f",
      { action: "signup" }
    ).then(function (token) {

      // DEBUG (keep for now)
      

      document.getElementById("captcha_token").value = token;

      const formData = new URLSearchParams();
      formData.append("email", emailInput.value);
      formData.append("timestamp", document.getElementById("timestamp").value);
      formData.append("user_agent", document.getElementById("user_agent").value);
      formData.append("captcha_token", token);

      fetch(WORKER_URL, {
        method: "POST",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded",
        },
        body: formData.toString(),
      })
	  .then(res => res.json())
	  .then(data => {
        if (data.success === true) {
          form.reset();
          showSuccess();
        } else {
          alert("Submission failed. Please try again.");
        }
      })

        .catch(() => {
          alert("Submission failed. Please try again.");
        });

    });
  });
});

function showSuccess() {
  successToast.style.display = "block";
  setTimeout(() => {
    successToast.style.display = "none";
  }, 3000);
}
</script>


<!-- UserWay config -->
<script>
  window._userway_config = {
    position: "bottom-right",
    offset: { vertical: 20, horizontal: 20 }
  };
</script>

<script>
  (function(d){
    var s = d.createElement("script");
    s.setAttribute("data-account", "YOUR_WIDGET_ID");
    s.src = "https://cdn.userway.org/widget.js";
    (d.body || d.head).appendChild(s);
  })(document);
</script>
<script src="https://www.google.com/recaptcha/api.js?render=6LdDTj4sAAAAAK4Mvik32d2ljlf87pDxAwoMx32f"></script>
</body>
</html>
